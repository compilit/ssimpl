<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>UCAN - User Controlled Authorization Networks - SSIMPL</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">SSIMPL</a>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#ucan-user-controlled-authorization-networks" class="nav-link">UCAN - User Controlled Authorization Networks</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#ucan-connect" class="nav-link">'UCAN Connect'</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#implementation-of-the-ucan-connect-flow" class="nav-link">Implementation of the UCAN Connect flow</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#delegated-signing-using-ucan" class="nav-link">Delegated signing using UCAN</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="ucan-user-controlled-authorization-networks">UCAN - User Controlled Authorization Networks</h1>
<p>To align with Web3 standards, DoaToa has adopted UCAN. UCAN challenges the traditional client-server model, shifting
control to the client.</p>
<p>Clients generate their own JWTs, specifying the request and resource they intend to access. Each JWT is signed with the
userâ€™s private key, allowing the server to verify the signature and determine whether access should be granted. This
essentially reverses the OAuth 2.0 flow, where clients request a server-issued JWT with specific scopes.</p>
<p>It should be noted that UCAN was originally designed for "delegated authorization". Meaning, an issuer creates a token
that allows the bearer of the token to perform certain actions on certain resources. For authentication, an addition is
required.</p>
<h2 id="ucan-connect">'UCAN Connect'</h2>
<p>Like Open ID Connect adds an identification layer to OAuth2, UCAN Connect also adds an identification layer to UCAN.
By embedding (verified) claims within UCAN JWTs, authentication systems eliminate the need to store user data, further
decentralizing trust. The receiver of the token notifies the issuer of the token which scope(s) they would like to
receive, and the issuer adds the related claims to the token. The receiver also should specify where the JWT should be
sent.</p>
<h2 id="implementation-of-the-ucan-connect-flow">Implementation of the UCAN Connect flow</h2>
<p>So how would all of this work in a real-world example? Let's set up a scenario. We start with three parties:</p>
<ul>
<li>Party A. The owner of the identity, aka the issuer of the UCAN token.</li>
<li>Party B. The id-wallet of the owner (like DoaToa).</li>
<li>Party C. A website, let's say a webshop called "foo-bar.baz".</li>
<li>Party D. The server of "foo-bar.baz".</li>
</ul>
<p>Pre-requisite: both Party A/B, and Party C/D have a DID, signed by DoaToa. For a non-natural person, this means a DID
from someone inside the legal entity, willing to represent the legal entity.</p>
<p>Typically, A will visit C, which at some point requires A to identify themselves (to complete an order, for example).</p>
<p>Party C has to create a scannable image (like a QR-code), which provides Party B all necessary information to
authenticate Party A:</p>
<ul>
<li>The DID of Party C.</li>
<li>The scopes of Party A that Party C requires.</li>
<li>A connection proposal. Containing either a channel id - used to set up a WebRTC channel, or an authentication
  endpoint (Party D) - to which the token should be sent.</li>
</ul>
<p>This payload MUST be a multibase-encoded JSON message:</p>
<pre><code class="language-json">{
  &quot;requestor&quot;: &quot;did:key:a1b2c3d4e5f6g7h8ij9k0&quot;,
  &quot;scopes&quot;: [
    &quot;did&quot;,
    &quot;private-address&quot;
  ],
  &quot;destination&quot;: {
    &quot;channelId&quot;: &quot;someId&quot;,
    &quot;authenticationEndpoint&quot;: &quot;someEndpoint&quot;
  }
}
</code></pre>
<h3 id="authentication-through-webrtc">Authentication through WebRTC</h3>
<p>Party D SHOULD initiate the WebRTC connection using the specified channel id. Party C is also allowed to do so, but that
would expose the UCAN token to Party C, which is less secure. Party B will do so some seconds after
scanning the payload. After the connection is set up, Party B will send the UCAN Connect token. Afterward, the
connection is closed.</p>
<h3 id="authentication-through-an-endpoint">Authentication through an endpoint</h3>
<p>The Party D connection endpoint MUST have the same domain as that of Party C. A subdomain is allowed.
The connection endpoint MUST be as follows:</p>
<p>```http request
POST /ucan-connect/auth HTTP/2
Authorization: "Bearer ${theUCANConnectToken}"</p>
<p>(no body should be provided)
```</p>
<p>This endpoint MUST respond with either a 200 OK or a 401 UNAUTHENTICATED</p>
<ul>
<li>200 OK: the tokens' signature matches the provided DID</li>
<li>401 UNAUTHENTICATED: the tokens' signature does not match the provided DID. The DID will be in the 'claims' array of
  the UCAN token. Or the DID does not match the specified public key.</li>
</ul>
<p>Then Party D SHOULD provide Party C with another token, specific for the current context, so Party C doesn't need to
know anything about Party A.</p>
<h2 id="delegated-signing-using-ucan">Delegated signing using UCAN</h2>
<p>By creating a dedicated, short-lived and identity-bound token (by setting receivers' DID as the audience of the token), a user can delegate signing authority towards another
entity, like the website they are currently on. The UCAN token is then embedded in the signature JWT in the prf-array.
This is relevant if the user is adding content to the website and the
website wants to have this content bound to a DID.</p>
<p>The implications are that all content on the internet HAS to be tied to an author, producer, etc. Which means that
fraudulent content, like non-consensual, AI-generated media, will have to signed as well.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
